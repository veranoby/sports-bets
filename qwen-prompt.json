{
  "‚ö†Ô∏è_CRITICAL_PRE_REQUISITE": {
    "MANDATORY_READ": "brain/multi_ai_coordination_strategy.json - COMPLETE FILE, NO ASSUMPTIONS",
    "REASON": "This file contains DIRECTOR_PLANNING_PROTOCOL, AUDIT_AND_ANALYSIS_METHODOLOGY_PROTOCOL, and validation gates that are NON-NEGOTIABLE",
    "YOUR_ROLE": "Executor - Must operate under simulate-y-confirmar protocol. Simulation before execution is MANDATORY, not optional.",
    "PROFESSIONAL_STANDARD": "Deep, systematic analysis. NO assumptions. NO delirium. Code must be production-ready."
  },

  "‚ö°_EXECUTIVE_SUMMARY": {
    "task": "Complete admin article management workflow at /admin/articles with proper UI, editor, and role-based entity assignment",
    "scope": "frontend/src/pages/admin/Articles.tsx + ArticleEditorForm.tsx + related components",
    "priority": "HIGH - Admin article CRUD must be fully functional with proper UX"
  },

  "üìã_DETAILED_REQUIREMENTS": {
    "requirement_1_article_list_display": {
      "location": "Secci√≥n 'Gesti√≥n General' - l√≠neas 560-730",
      "current_state": "Shows articles in table with image preview, title, summary, author info",
      "required_changes": [
        "1) Add STATUS CHIP to each row (BEFORE title) showing: draft|pending|published|archived with color coding",
        "2) Replace icon buttons with TEXT BUTTONS (no lucide icons) - buttons must say: 'Preview' 'Edit' 'Approve' 'Reject' 'Delete'",
        "3) Approve button: calls handleApproveArticle() ‚Üí PATCH /articles/:id/approve",
        "4) Reject button: calls openRejectModal() ‚Üí opens modal for rejection message",
        "5) Delete button: existing handleDeleteArticle() functionality"
      ],
      "button_styling": "Use consistent button classes: px-3 py-1 text-sm font-medium rounded - no icons, text only",
      "visual_priority": "Status ‚Üí Title ‚Üí Summary ‚Üí Author ‚Üí Date | [Preview] [Edit] [Approve] [Reject] [Delete]"
    },

    "requirement_2_edit_modal_with_quill_editor": {
      "location": "Modal Crear/Editar Art√≠culo - l√≠neas 798-831",
      "component": "ArticleEditorForm.tsx",
      "current_problem": "Uses basic <textarea> for content. Should use ReactQuill like user ArticleEditor.tsx",
      "required_implementation": [
        "1) Replace textarea (lines 132-139 in ArticleEditorForm) with ReactQuill component",
        "2) Import ReactQuill: import ReactQuill from 'react-quill-new';",
        "3) Copy Quill toolbar config from frontend/src/components/articles/ArticleEditor.tsx lines 156-177",
        "4) Must support: headers, bold, italic, links, lists, images",
        "5) Content field must store/retrieve HTML (as it does now)"
      ],
      "reference_implementation": "frontend/src/components/articles/ArticleEditor.tsx lines 147-185"
    },

    "requirement_3_image_upload_in_modal": {
      "location": "ArticleEditorForm.tsx - currently missing image upload",
      "required_implementation": [
        "1) Add image preview section (like ArticleEditor.tsx lines 66-124)",
        "2) File input with: accept='image/jpeg,image/jpg,image/png,image/webp'",
        "3) Upload button that calls uploadsAPI.uploadImage(file)",
        "4) Image preview showing uploaded image or placeholder",
        "5) Remove button to clear selected image",
        "6) Display upload progress while uploading"
      ],
      "reference": "frontend/src/components/articles/ArticleEditor.tsx lines 39-61 (handleImageChange function)"
    },

    "requirement_4_associated_entity_mandatory": {
      "location": "ArticleEditorForm.tsx lines 177-192 (current 'venue_id' optional field)",
      "current_state": "Optional select for venue_id. Says 'Associated Entity (Optional)' - WRONG",
      "required_changes": [
        "1) Change label to 'Associated Entity (REQUIRED)' - NOT optional",
        "2) Make select field REQUIRED - validation should fail if empty",
        "3) In CREATION mode: populate with list of all users (admins, venues, galleras)",
        "4) In EDIT mode: show current user who created article (read-only or selectable for admin reassign)",
        "5) Filter options to show: username (role) for clarity"
      ],
      "validation_logic": "Form should not submit if Associated Entity is empty"
    },

    "requirement_5_creation_vs_edit_mode_logic": {
      "creation_mode": {
        "trigger": "Click 'Crear Art√≠culo' button or in general admin management section",
        "author_field": "Must be EMPTY - admin selects via 'Associated Entity' dropdown",
        "entity_options": "Load all users (admins, venues, galleras) from API",
        "status_default": "draft (admin can save as draft or pending/published)",
        "image": "Allow upload via file input"
      },
      "edit_mode": {
        "trigger": "Click 'Edit' button on existing article in list",
        "author_field": "Show original author (who created it) - consider if admin can reassign",
        "entity_options": "Show current author, maybe allow change",
        "status_current": "Show current status (draft|pending|published|archived)",
        "image": "Show current image with option to change/remove"
      }
    },

    "requirement_6_modal_actions": {
      "location": "ArticleEditorForm.tsx - button section",
      "required_buttons": [
        "1) Cancel button - closes modal without saving",
        "2) Save as Draft button - saves with status='draft'",
        "3) Submit for Review button - saves with status='pending'",
        "4) Publish button (admin only) - saves with status='published'",
        "Note: Button labels/availability may differ based on article current status and user role"
      ]
    }
  },

  "üî¥_CRITICAL_INVESTIGATION_BEFORE_CODE": {
    "investigation_1_pending_articles_empty": {
      "issue": "pendingArticles array is empty in /admin/articles, buttons don't show",
      "root_cause_hypothesis": [
        "A) articlesAPI.getAll() response doesn't include status='pending' articles for admin",
        "B) Response structure differs from expected { success, data: { articles: [...] } }",
        "C) Filter logic at line 127-132 doesn't correctly extract pending articles",
        "D) User is not authenticated as admin"
      ],
      "investigation_steps": [
        "1) Open browser F12 ‚Üí Network tab",
        "2) Reload /admin/articles",
        "3) Find GET /articles request ‚Üí Click it",
        "4) Check Response tab - does it contain articles with status='pending'?",
        "5) If yes: problem is frontend filter logic. If no: problem is backend endpoint"
      ],
      "backend_endpoint_check": [
        "curl -H 'Authorization: Bearer ADMIN_TOKEN' 'http://localhost:3001/api/articles?limit=1000'",
        "Does response include pending articles? If not, backend GET /articles has issue"
      ]
    },

    "investigation_2_current_articleeditorform_limitations": {
      "issue": "ArticleEditorForm.tsx is too basic for admin use",
      "current_implementation": [
        "- No Quill editor (textarea only)",
        "- No image upload capability",
        "- venue_id field but confusing UX",
        "- No role-based field handling"
      ],
      "compare_with": "ArticleEditor.tsx (user version) has proper image upload, Quill, good UX",
      "action": "ArticleEditorForm must be enhanced to match or exceed user ArticleEditor functionality"
    }
  },

  "üéØ_IMPLEMENTATION_TASKS_FOR_QWEN": {
    "PHASE_1_INVESTIGATION_AND_SIMULATION": {
      "task_1": "Read multi_ai_coordination_strategy.json COMPLETELY - document key protocols applicable to this task",
      "task_2": "Investigate why pendingArticles is empty - use Network tab debugging",
      "task_3": "Analyze ArticleEditor.tsx (user version) to understand proper image upload and Quill integration",
      "task_4": "Analyze ArticleEditorForm.tsx current implementation - identify gaps vs requirements",
      "task_5": "Simulate the changes mentally - plan exact modifications to each file",
      "task_6": "Document simulation findings in brief summary before coding"
    },

    "PHASE_2_CORE_IMPLEMENTATION": {
      "task_1_fix_pending_articles_display": {
        "status": "BLOCKING",
        "description": "Ensure pending articles render in secci√≥n 1",
        "investigation_required": true,
        "simulate_before_coding": true
      },

      "task_2_update_article_list_ui": {
        "file": "frontend/src/pages/admin/Articles.tsx",
        "lines": "560-730 (Gesti√≥n General section)",
        "changes": [
          "1) Add STATUS CHIP before title for each article",
          "2) Replace icon buttons with TEXT buttons",
          "3) Add 'Approve' button (green) - calls handleApproveArticle()",
          "4) Add 'Reject' button (red) - calls openRejectModal()",
          "5) Keep existing 'Delete' functionality",
          "6) Update button styling to be text-based, not icon-based"
        ],
        "simulate_before_coding": true
      },

      "task_3_enhance_articleeditorform_quill": {
        "file": "frontend/src/components/admin/ArticleEditorForm.tsx",
        "changes": [
          "1) Add ReactQuill import",
          "2) Replace <textarea> content field with <ReactQuill>",
          "3) Copy toolbar config from ArticleEditor.tsx",
          "4) Ensure HTML content is preserved on save/load"
        ],
        "reference": "ArticleEditor.tsx lines 147-185",
        "simulate_before_coding": true
      },

      "task_4_add_image_upload": {
        "file": "frontend/src/components/admin/ArticleEditorForm.tsx",
        "changes": [
          "1) Add image preview section (model from ArticleEditor.tsx)",
          "2) Add file input for image selection",
          "3) Implement uploadImage handler",
          "4) Show upload progress",
          "5) Allow image removal"
        ],
        "reference": "ArticleEditor.tsx lines 39-61, 66-124",
        "simulate_before_coding": true
      },

      "task_5_fix_associated_entity_mandatory": {
        "file": "frontend/src/components/admin/ArticleEditorForm.tsx",
        "changes": [
          "1) Change label from 'Optional' to 'REQUIRED'",
          "2) Make select field required in validation",
          "3) Load users list on component mount",
          "4) Filter to show: username (role type) for clarity"
        ],
        "modes": {
          "creation": "Empty select - user picks from list",
          "edit": "Show current author - allow admin to reassign if needed"
        },
        "simulate_before_coding": true
      },

      "task_6_implement_button_actions": {
        "buttons_to_implement": [
          "Cancel",
          "Save as Draft",
          "Submit for Review (status=pending)",
          "Publish (status=published, admin only)"
        ],
        "file": "ArticleEditorForm.tsx",
        "simulate_before_coding": true
      }
    },

    "PHASE_3_VALIDATION_AND_TESTING": {
      "validation_checklist": [
        "[ ] Pending articles render with status chip",
        "[ ] All 5 action buttons visible (Preview, Edit, Approve, Reject, Delete)",
        "[ ] Edit button opens modal with Quill editor",
        "[ ] Image upload works in modal",
        "[ ] Associated Entity field is required",
        "[ ] Creation mode: select from user list",
        "[ ] Edit mode: shows current author",
        "[ ] Approve button: article moves to published",
        "[ ] Reject button: opens modal, saves message, moves to draft",
        "[ ] Delete button: removes article",
        "[ ] No console errors",
        "[ ] TypeScript compilation succeeds: npx tsc --noEmit",
        "[ ] CSS buttons render properly (text, not icons)"
      ]
    }
  },

  "üìä_SIMULATION_TEMPLATE": {
    "before_you_code": "Document these findings",
    "what_will_change": "List exact file changes and line numbers",
    "what_could_break": "Identify potential issues (imports, dependencies, logic conflicts)",
    "how_to_test": "Define manual test steps for each feature",
    "success_indicators": "Clear pass/fail criteria"
  },

  "üîß_DEBUGGING_TOOLS_AVAILABLE": [
    "Browser DevTools (F12) - Network, Console, Elements tabs",
    "npm run dev - local dev server",
    "npx ts-node - script execution",
    "curl - API testing",
    "VS Code debugger"
  ],

  "üöÄ_EXECUTION_STANDARDS": {
    "code_quality": "Production-ready, no TODOs, no debug logs left in commits",
    "testing": "Manual QA each feature before considering done",
    "documentation": "Update brain files if interfaces change",
    "professionalism": "Deep analysis, systematic implementation, comprehensive validation"
  },

  "‚ö†Ô∏è_REMINDERS_FOR_QWEN": {
    "1_read_coordination_file": "brain/multi_ai_coordination_strategy.json is MANDATORY. Read completely. Not optional.",
    "2_simulate_first": "Use SIMULATE-Y-CONFIRMAR protocol from coordination file. Simulate changes before coding.",
    "3_no_assumptions": "Debug first, understand root cause, then implement. Don't guess.",
    "4_professional_depth": "This is admin-facing functionality. Quality and thoroughness non-negotiable.",
    "5_validation_gates": "TypeScript must compile. Test in browser before claiming done."
  }
}
