{
  "development_priority_stack": [
    {
      "priority": "P0_SECURITY_COMPLETED",
      "task_description": "✅ Concurrent Login Prevention + Membership Request Bug Fix + Session Cleanup",
      "completion_date": "2025-11-21",
      "rationale": "Fixed 3 critical security/revenue bugs: (1) Concurrent login vulnerability allowing credential sharing, (2) Membership acceptance bug preventing subscription upgrades, (3) Session table bloat prevention",
      "impact": "CRITICAL - Prevents credential sharing, fixes revenue-blocking bug, improves long-term database performance",
      "source_file": "brain/backlog.json (CONCURRENT_LOGIN_SECURITY_FIX_COMPLETED, MEMBERSHIP_ACCEPTANCE_BUG_FIX_COMPLETED, SESSION_CLEANUP_CRON_JOB_IMPLEMENTATION)",
      "git_commits": [
        "1b391da - feat: concurrent login prevention with session cleanup",
        "dbdecdc - fix: TypeScript row locking syntax",
        "244833c - feat: concurrent login rejection + membership acceptance fix",
        "bcf6aa7 - feat: frontend handling for concurrent login rejection"
      ],
      "testing_recommended": "Test concurrent login rejection on 2 browsers, test membership acceptance (FREE → DAILY/MONTHLY), verify session cleanup after 6 hours"
    },
    {
      "priority": "P0_CRITICAL",
      "task_description": "Solucionar Gaps de E2E Frontend y Estabilidad",
      "rationale": "La validación E2E falló en todas las capas, bloqueando la validación manual y la preparación para producción. La aplicación no es testeable ni estable en su estado actual.",
      "impact": "Bloqueador total para el lanzamiento. Sin esto, no se puede verificar que el producto funcione.",
      "source_file": "brain/backlog.json (e2e_frontend_validation_2025_11_10)"
    },
    {
      "priority": "P0",
      "task_description": "Resolver páginas de Admin rotas (Finance, Monitoring)",
      "rationale": "Las páginas de administración críticas para la operación y monitoreo del negocio no están funcionales, arrojando errores 404 y spam en la consola.",
      "impact": "Impide la gestión y monitoreo post-lanzamiento.",
      "source_file": "brain/backlog.json (broken_pages_scan_implementation_2025_11_11)"
    },
    {
      "priority": "P0_INFRASTRUCTURE_DECISION",
      "task_description": "Implementar OPTION B.1: Nginx RTMP + PostgreSQL local + Bunny CDN (Phase 2 opcional)",
      "rationale": "Decision crítica seleccionada (2025-11-20): Stack de streaming económico y escalable. Nginx RTMP (self-managed, $0) + PostgreSQL local ($0) + Bunny CDN on-demand. Ahorra $450 en primeros 6 meses vs Option B.2 (Neon managed).",
      "business_impact": "$155-195/mo MVP, $263-411/mo con CDN scaling. Escalable a 1000+ concurrent. Documentado en prd_system.json (líneas 119-170) y sdd_system.json (líneas 75-112).",
      "technical_impact": "Nginx RTMP genera HLS localmente. Video.js ya integrado. Zero logic changes, solo configuración .env. Phase 2 (CDN) requiere SOLO cambio de URL variable, sin refactor de código.",
      "executor": "QWEN (qwen3-coder-plus-2025-09-23)",
      "execution_plan": "qwen-prompt.json (3 tareas, 60 minutos máximo)",
      "source_file": "brain/backlog.json (NGINX_RTMP_CONFIG_PHASE_1_IMPLEMENTATION)",
      "success_criteria": [
        "Backend .env.production: STREAM_SERVER_URL → nginx-server | CDN_URL → nginx-server",
        "Frontend .env.production: VITE_STREAM_BASE_URL → nginx-server/hls (Phase 1) con template para Phase 2 CDN",
        "Brain files: api_endpoints_reference.json + typescript_interfaces_reference.json actualizado con metadata OPTION B.1",
        "Validation: npx tsc --noEmit (0 errors) + npm run build (success)"
      ]
    },
    {
      "priority": "P1_PERFORMANCE_OPTIMIZATION_PLAN_READY",
      "task_description": "✅ Backend Performance Analysis Completed + Implementation Plan Created",
      "completion_date": "2025-11-21 (Plan), 2025-11-20 (Analysis)",
      "rationale": "QWEN completed comprehensive 4-phase SSE/WebSocket analysis. Director (Sonnet) validated findings and created implementation roadmap with 7 optimizations ranked by ROI.",
      "business_impact": "$40,800/year potential savings ($3,400/month). Phase 1 alone saves $2,900/month with 5-day break-even. Prevents exponential cloud costs at scale.",
      "technical_impact": "7 optimizations identified: connection limits (ROI 500), cache TTL (ROI 167), event history (ROI 133), adaptive heartbeat (ROI 60), message batching (ROI 67), pool monitoring (ROI 37.5), compression (ROI 18.75)",
      "implementation_plan": "qwen-optimization-plan.json",
      "source_file": "brain/backlog.json (BACKEND_PERFORMANCE_ANALYSIS_COMPLETED)",
      "next_steps": [
        "1. Review and approve qwen-optimization-plan.json",
        "2. Setup load testing environment (k6 or artillery)",
        "3. Run baseline test (25 concurrent users)",
        "4. Implement Phase 1 (Connection Limits + Cache TTL + Event History) - 10 hours",
        "5. Validate with load test (100 concurrent users)"
      ],
      "recommended_priority": "P1_HIGH - Implement Phase 1 immediately (5-day ROI break-even)"
    },
    {
      "priority": "P1",
      "task_description": "Implementar página de historial global de apuestas para Admin",
      "rationale": "La auditoría de funcionalidades de historial reveló que no existe una vista para que el admin supervise todas las apuestas, lo cual es un requisito de negocio para la operación.",
      "impact": "Baja visibilidad operativa y de negocio sobre la actividad de apuestas.",
      "source_file": "brain/backlog.json (recent_achievements_2025_11_07_auditoria_history_features)"
    },
    {
      "priority": "P2",
      "task_description": "Añadir funcionalidad de exportación a reportes de Admin",
      "rationale": "Los reportes financieros y de apuestas carecen de capacidad de exportación (CSV/PDF), limitando su utilidad para análisis externo.",
      "impact": "Dificulta el análisis de negocio y la contabilidad.",
      "source_file": "brain/backlog.json (recent_achievements_2025_11_07_auditoria_history_features)"
    }
  ],
  "decision_maker_priorities": [
    {
      "stakeholder": "Solo founder/developer (veranoby)",
      "concerns": [
        "Entrega del MVP en el plazo de 15 días.",
        "Resolución del rendimiento de la base de datos (CRÍTICO).",
        "Activación de la generación de ingresos (suscripciones).",
        "Funcionalidad completa del sistema de apuestas."
      ],
      "source_file": "brain/prd_system.json"
    }
  ],
  "implementation_roadmap": {
    "mvp_sprint_15_dias": [
      { "week": 1, "focus": "Implementación del núcleo (SSE, Frontend, Ventanas de Apuestas, Dashboard Operador)", "status": "Mayormente completado, con gaps de integración." },
      { "week": 2, "focus": "Optimización y Estabilización (Rendimiento BD, Pruebas, Pulido, Despliegue)", "status": "En progreso, rendimiento de BD resuelto, pero bloqueado por estabilidad de frontend." }
    ]
  },
  "success_gates": [
    {
      "phase": "Pre-Lanzamiento",
      "gate": "Validación E2E del Frontend exitosa.",
      "criteria": "Las 5 capas de la simulación E2E deben pasar al menos en un 80% para poder realizar la validación manual.",
      "status": "BLOQUEADO"
    },
    {
      "phase": "Lanzamiento MVP",
      "gate": "Despliegue en producción.",
      "criteria": "El sistema debe estar desplegado y funcional para el 21 de Septiembre.",
      "status": "EN RIESGO"
    },
    {
      "phase": "Post-Lanzamiento (Mes 1)",
      "gate": "Validación de negocio.",
      "criteria": "Alcanzar 25+ suscriptores y $500+ en ingresos.",
      "status": "PENDIENTE"
    }
  ],
  "cross_references_to_migrate": [
    {
      "informacion": "Métricas de éxito del negocio (25+ suscriptores, $500+ ingresos en Mes 1).",
      "ubicacion_original": "brain/prd_system.json",
      "destino_recomendado": "objectives_memory_index.json"
    }
  ],
  "boundaries_and_cross_references": {
    "ssot_declaration": "Este archivo es la SSOT para la lista priorizada de tareas y objetivos (P0-P3).",
    "references": "El progreso detallado de las tareas se reporta en `backlog.json`. Las métricas de éxito se definen en `objectives_memory_index.json`."
  }
}